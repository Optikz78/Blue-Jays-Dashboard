<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Blue Jays 2026 ‚Äî Home Game Dashboard</title>
<link href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;500;600;700&family=Playfair+Display:wght@700;800&display=swap" rel="stylesheet">
<style>
:root{--bg-deep:#0B1624;--bg-mid:#111E33;--border:rgba(255,255,255,0.06);--text-primary:#E2E8F4;--text-secondary:#8497B5;--text-muted:#4A5F7E;--jay:#2563EB;--leanne:#DC2626;--geoff:#059669;--rob:#D97706;--accent:#3B82F6}
*{box-sizing:border-box;margin:0;padding:0}
body{font-family:'DM Sans',sans-serif;background:var(--bg-deep);color:var(--text-primary);min-height:100vh}
body::before{content:'';position:fixed;inset:0;background:radial-gradient(ellipse 80% 60% at 20% 10%,rgba(37,99,235,0.06) 0%,transparent 60%),radial-gradient(ellipse 60% 50% at 80% 90%,rgba(220,38,38,0.04) 0%,transparent 60%);pointer-events:none}
.app{position:relative;z-index:1}
.login-screen{min-height:100vh;display:flex;align-items:center;justify-content:center;animation:fadeUp .5s ease}
.login-box{text-align:center;max-width:400px;padding:40px 24px}
.login-box .logo{font-size:52px;display:block;margin-bottom:8px;filter:drop-shadow(0 4px 20px rgba(37,99,235,0.3))}
.login-box h1{font-family:'Playfair Display',serif;font-size:34px;font-weight:800;letter-spacing:-.03em;margin-bottom:2px;background:linear-gradient(135deg,#E2E8F4 30%,#8497B5);-webkit-background-clip:text;-webkit-text-fill-color:transparent}
.login-box .subtitle{font-size:12px;letter-spacing:.15em;text-transform:uppercase;color:var(--text-muted);margin-bottom:36px}
.login-box .prompt{color:var(--text-secondary);font-size:15px;margin-bottom:20px}
.login-btn{display:flex;align-items:center;gap:12px;width:100%;padding:15px 20px;margin-bottom:10px;border-radius:10px;border:2px solid var(--border);background:rgba(255,255,255,0.03);color:var(--text-primary);font-size:16px;font-weight:600;font-family:'DM Sans',sans-serif;cursor:pointer;transition:all .25s}
.login-btn:hover{transform:translateY(-1px)}
.login-btn .dot{width:12px;height:12px;border-radius:50%;flex-shrink:0}
.login-btn .count{margin-left:auto;opacity:.4;font-weight:400;font-size:14px}
.login-btn[data-p="Jay"]{border-color:rgba(37,99,235,0.3)}.login-btn[data-p="Jay"]:hover{background:var(--jay);border-color:var(--jay)}
.login-btn[data-p="Leanne"]{border-color:rgba(220,38,38,0.3)}.login-btn[data-p="Leanne"]:hover{background:var(--leanne);border-color:var(--leanne)}
.login-btn[data-p="Geoff"]{border-color:rgba(5,150,105,0.3)}.login-btn[data-p="Geoff"]:hover{background:var(--geoff);border-color:var(--geoff)}
.login-btn[data-p="Rob"]{border-color:rgba(217,119,6,0.3)}.login-btn[data-p="Rob"]:hover{background:var(--rob);border-color:var(--rob)}
.header{padding:16px 24px;display:flex;align-items:center;justify-content:space-between;border-bottom:1px solid var(--border);flex-wrap:wrap;gap:12px}
.header-left{display:flex;align-items:center;gap:12px}
.header-left .logo{font-size:26px}
.header-left h1{font-family:'Playfair Display',serif;font-size:20px;font-weight:800;letter-spacing:-.02em}
.header-left .tag{font-size:10px;color:var(--text-muted);text-transform:uppercase;letter-spacing:.1em}
.header-right{display:flex;align-items:center;gap:10px;flex-wrap:wrap}
.user-badge{display:flex;align-items:center;gap:8px;padding:5px 14px;border-radius:8px;background:rgba(255,255,255,0.05);font-size:14px;font-weight:600}
.user-badge .dot{width:9px;height:9px;border-radius:50%}
.btn-sm{padding:5px 12px;border-radius:7px;border:1px solid var(--border);background:transparent;color:var(--text-muted);font-size:12px;font-family:'DM Sans',sans-serif;cursor:pointer;transition:all .2s}
.btn-sm:hover{background:rgba(255,255,255,0.05);color:var(--text-secondary)}
.board-badge{background:var(--rob);color:#fff;padding:3px 11px;border-radius:20px;font-size:12px;font-weight:600;animation:pulse 2s infinite}
.stats-bar{display:flex;gap:1px;margin:20px 24px;border-radius:12px;overflow:hidden}
.stat-block{padding:13px 16px;cursor:pointer;transition:all .25s;min-width:55px;position:relative}
.stat-block .num{font-size:22px;font-weight:700}
.stat-block .label{font-size:10px;opacity:.8;text-transform:uppercase;letter-spacing:.06em;margin-top:2px}
.stat-block.dimmed{opacity:.25}
.stat-block .diff{position:absolute;top:6px;right:8px;font-size:10px;font-weight:700;opacity:.8}
.controls{display:flex;align-items:center;justify-content:space-between;padding:0 24px;margin-bottom:16px;flex-wrap:wrap;gap:10px}
.tab-group{display:flex;gap:3px;background:rgba(255,255,255,0.03);border-radius:8px;padding:3px}
.tab-btn{padding:7px 16px;border-radius:6px;border:none;font-size:13px;font-weight:500;font-family:'DM Sans',sans-serif;cursor:pointer;background:transparent;color:var(--text-muted);transition:all .2s}
.tab-btn.active{background:rgba(255,255,255,0.1);color:var(--text-primary)}
.month-tabs{display:flex;gap:3px;flex-wrap:wrap}
.month-btn{padding:5px 11px;border-radius:6px;border:none;font-size:12px;font-weight:500;font-family:'DM Sans',sans-serif;cursor:pointer;background:rgba(255,255,255,0.03);color:var(--text-muted);transition:all .2s}
.month-btn.active{background:var(--jay);color:#fff}
.calendar{padding:0 24px 24px}
.cal-grid{display:grid;grid-template-columns:repeat(7,1fr);gap:1px;background:rgba(255,255,255,0.02);border-radius:12px;overflow:hidden}
.cal-header{padding:10px 6px;text-align:center;font-size:11px;color:var(--text-muted);font-weight:600;text-transform:uppercase;letter-spacing:.08em;background:rgba(0,0,0,0.25)}
.cal-day{padding:5px;background:rgba(0,0,0,0.15);min-height:88px}
.cal-day.today{border-left:2px solid var(--accent);background:rgba(59,130,246,0.06)}
.cal-day.empty{background:rgba(0,0,0,0.2)}
.cal-day .day-num{font-size:12px;color:var(--text-muted);font-weight:500;margin-bottom:3px;padding-left:2px}
.cal-day.today .day-num{color:var(--accent);font-weight:700}
.game-chip{padding:4px 6px;border-radius:5px;margin-bottom:2px;font-size:10px;font-weight:600;line-height:1.3;color:#fff;transition:all .15s;cursor:default}
.game-chip.mine{cursor:pointer;border:1px solid rgba(255,255,255,0.25)}
.game-chip.mine:hover{filter:brightness(1.2);transform:scale(1.03)}
.game-chip.dimmed{opacity:.2}
.game-chip.on-board{opacity:.45;border:1px dashed rgba(255,255,255,0.4)}
.game-chip .opp{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.game-chip .meta{opacity:.7;font-size:9px}
.cal-hint{text-align:center;font-size:11px;color:var(--text-muted);margin-top:10px}
.list-view{padding:0 24px 24px;overflow-x:auto}
.list-table{width:100%;border-collapse:collapse;font-size:13px;border-radius:12px;overflow:hidden;border:1px solid var(--border)}
.list-table th{padding:10px 14px;text-align:left;font-size:10px;color:var(--text-muted);font-weight:600;text-transform:uppercase;letter-spacing:.07em;background:rgba(0,0,0,0.3)}
.list-table td{padding:10px 14px;border-bottom:1px solid rgba(255,255,255,0.02)}
.list-table tr:nth-child(even){background:rgba(0,0,0,0.08)}
.list-table tr:nth-child(odd){background:rgba(0,0,0,0.15)}
.assignee-pill{display:inline-block;padding:3px 10px;border-radius:5px;font-size:12px;font-weight:600;color:#fff}
.action-btn{padding:4px 10px;border-radius:5px;border:none;font-size:11px;font-family:'DM Sans',sans-serif;cursor:pointer;transition:all .2s}
.action-btn.post{background:rgba(245,158,11,0.2);color:#F59E0B;border:1px solid rgba(245,158,11,0.3)}
.action-btn.post:hover{background:rgba(245,158,11,0.3)}
.action-btn.grab{background:rgba(5,150,105,0.2);color:#10B981;border:1px solid rgba(5,150,105,0.3)}
.action-btn.grab:hover{background:rgba(5,150,105,0.3)}
.action-btn.unpost{background:rgba(239,68,68,0.15);color:#EF4444;border:1px solid rgba(239,68,68,0.2)}
.action-btn.unpost:hover{background:rgba(239,68,68,0.25)}
.swap-board{padding:0 24px 24px;max-width:760px}
.board-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:16px;flex-wrap:wrap;gap:8px}
.board-title{font-size:13px;color:var(--text-secondary);text-transform:uppercase;letter-spacing:.08em;font-weight:600}
.board-card{padding:16px;border-radius:10px;margin-bottom:8px;background:rgba(245,158,11,0.06);border:1px solid rgba(245,158,11,0.15);display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;gap:10px;animation:fadeUp .3s ease}
.board-card .game-info strong{color:var(--text-primary)}
.board-card .game-info .sub{font-size:12px;color:var(--text-secondary);margin-top:3px}
.board-card .posted-by{font-size:12px;color:var(--text-muted);margin-top:6px}
.board-actions{display:flex;gap:8px}
.btn-claim{padding:8px 20px;border-radius:7px;border:none;background:var(--geoff);color:#fff;font-size:13px;font-weight:600;font-family:'DM Sans',sans-serif;cursor:pointer;transition:all .2s}
.btn-claim:hover{filter:brightness(1.15)}
.btn-remove{padding:8px 16px;border-radius:7px;border:1px solid var(--border);background:transparent;color:var(--text-muted);font-size:13px;font-family:'DM Sans',sans-serif;cursor:pointer}
.empty-state{padding:48px;text-align:center;color:var(--text-muted);font-size:14px;line-height:1.6}
.history-section{margin-top:28px}
.history-card{padding:12px 16px;border-radius:8px;margin-bottom:4px;background:rgba(255,255,255,0.02);border:1px solid var(--border);font-size:13px;display:flex;justify-content:space-between;align-items:center;opacity:.5;flex-wrap:wrap;gap:6px}
.status-tag{padding:2px 8px;border-radius:4px;font-size:10px;font-weight:600;color:#fff}
.footer{padding:14px 24px;border-top:1px solid var(--border);display:flex;justify-content:space-between;font-size:11px;color:var(--text-muted);flex-wrap:wrap;gap:8px}
.notification{position:fixed;top:20px;right:20px;z-index:9999;padding:12px 20px;border-radius:10px;color:#fff;font-size:14px;font-weight:500;box-shadow:0 8px 28px rgba(0,0,0,0.5);animation:fadeIn .3s ease}
.notification.success{background:var(--geoff)}.notification.info{background:var(--accent)}.notification.error{background:var(--leanne)}
.modal-overlay{position:fixed;inset:0;background:rgba(0,0,0,0.7);display:flex;align-items:center;justify-content:center;z-index:1000;animation:fadeIn .2s ease}
.modal-box{background:var(--bg-mid);border-radius:14px;padding:28px;width:420px;max-width:92vw;border:1px solid rgba(255,255,255,0.08);animation:fadeUp .3s ease}
.modal-box h3{font-family:'Playfair Display',serif;font-size:20px;margin-bottom:8px}
.modal-box p{color:var(--text-secondary);font-size:14px;margin-bottom:20px;line-height:1.6}
.modal-actions{display:flex;gap:10px}
.btn-primary{flex:1;padding:12px 20px;border-radius:8px;border:none;background:var(--accent);color:#fff;font-size:14px;font-weight:600;font-family:'DM Sans',sans-serif;cursor:pointer}
.btn-secondary{padding:12px 20px;border-radius:8px;border:1px solid var(--border);background:transparent;color:var(--text-muted);font-size:14px;font-family:'DM Sans',sans-serif;cursor:pointer}
@keyframes fadeIn{from{opacity:0}to{opacity:1}}
@keyframes fadeUp{from{opacity:0;transform:translateY(12px)}to{opacity:1;transform:translateY(0)}}
@keyframes pulse{0%,100%{opacity:1}50%{opacity:.65}}
@media(max-width:700px){.cal-day{min-height:70px;padding:3px}.game-chip{padding:3px 4px;font-size:9px}.stats-bar{margin:12px 16px}.header,.controls,.calendar,.list-view,.swap-board,.footer{padding-left:16px;padding-right:16px}.list-table{font-size:11px}.list-table th,.list-table td{padding:8px 6px}}
</style>
</head>
<body>
<div class="app" id="app"></div>
<script>
const APPS_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbyb8gugqrnWLJtU04MVwdJzm2WnvXtAr-JPr8mkS5zNzcRUIWukjIy-LxN5qhxZ2D9uUA/exec';

const INITIAL_GAMES = [
{id:1,date:"2026-03-27",time:"07:07 PM",opponent:"Athletics",assignee:"Jay",onBoard:false,postedBy:""},
{id:2,date:"2026-03-28",time:"03:07 PM",opponent:"Athletics",assignee:"Rob",onBoard:false,postedBy:""},
{id:3,date:"2026-03-29",time:"01:37 PM",opponent:"Athletics",assignee:"Geoff",onBoard:false,postedBy:""},
{id:4,date:"2026-03-30",time:"07:07 PM",opponent:"Rockies",assignee:"Leanne",onBoard:false,postedBy:""},
{id:5,date:"2026-03-31",time:"07:07 PM",opponent:"Rockies",assignee:"Rob",onBoard:false,postedBy:""},
{id:6,date:"2026-04-01",time:"01:07 PM",opponent:"Rockies",assignee:"Jay",onBoard:false,postedBy:""},
{id:7,date:"2026-04-06",time:"07:07 PM",opponent:"Dodgers",assignee:"Leanne",onBoard:false,postedBy:""},
{id:8,date:"2026-04-07",time:"07:07 PM",opponent:"Dodgers",assignee:"Geoff",onBoard:false,postedBy:""},
{id:9,date:"2026-04-08",time:"03:07 PM",opponent:"Dodgers",assignee:"Rob",onBoard:false,postedBy:""},
{id:10,date:"2026-04-10",time:"07:07 PM",opponent:"Twins",assignee:"Leanne",onBoard:false,postedBy:""},
{id:11,date:"2026-04-11",time:"03:07 PM",opponent:"Twins",assignee:"Rob",onBoard:false,postedBy:""},
{id:12,date:"2026-04-12",time:"01:37 PM",opponent:"Twins",assignee:"Jay",onBoard:false,postedBy:""},
{id:13,date:"2026-04-24",time:"07:07 PM",opponent:"Guardians",assignee:"Leanne",onBoard:false,postedBy:""},
{id:14,date:"2026-04-25",time:"03:07 PM",opponent:"Guardians",assignee:"Rob",onBoard:false,postedBy:""},
{id:15,date:"2026-04-26",time:"01:37 PM",opponent:"Guardians",assignee:"Geoff",onBoard:false,postedBy:""},
{id:16,date:"2026-04-27",time:"07:07 PM",opponent:"Red Sox",assignee:"Jay",onBoard:false,postedBy:""},
{id:17,date:"2026-04-28",time:"07:07 PM",opponent:"Red Sox",assignee:"Rob",onBoard:false,postedBy:""},
{id:18,date:"2026-04-29",time:"03:07 PM",opponent:"Red Sox",assignee:"Geoff",onBoard:false,postedBy:""},
{id:19,date:"2026-05-08",time:"07:07 PM",opponent:"Angels",assignee:"Leanne",onBoard:false,postedBy:""},
{id:20,date:"2026-05-09",time:"03:07 PM",opponent:"Angels",assignee:"Rob",onBoard:false,postedBy:""},
{id:21,date:"2026-05-10",time:"01:37 PM",opponent:"Angels",assignee:"Geoff",onBoard:false,postedBy:""},
{id:22,date:"2026-05-11",time:"07:07 PM",opponent:"Rays",assignee:"Rob",onBoard:false,postedBy:""},
{id:23,date:"2026-05-12",time:"07:07 PM",opponent:"Rays",assignee:"Geoff",onBoard:false,postedBy:""},
{id:24,date:"2026-05-13",time:"07:07 PM",opponent:"Rays",assignee:"Leanne",onBoard:false,postedBy:""},
{id:25,date:"2026-05-22",time:"07:07 PM",opponent:"Pirates",assignee:"Jay",onBoard:false,postedBy:""},
{id:26,date:"2026-05-23",time:"03:07 PM",opponent:"Pirates",assignee:"Leanne",onBoard:false,postedBy:""},
{id:27,date:"2026-05-24",time:"12:15 PM",opponent:"Pirates",assignee:"Jay",onBoard:false,postedBy:""},
{id:28,date:"2026-05-25",time:"07:07 PM",opponent:"Marlins",assignee:"Rob",onBoard:false,postedBy:""},
{id:29,date:"2026-05-26",time:"07:07 PM",opponent:"Marlins",assignee:"Jay",onBoard:false,postedBy:""},
{id:30,date:"2026-05-27",time:"01:07 PM",opponent:"Marlins",assignee:"Geoff",onBoard:false,postedBy:""},
{id:31,date:"2026-06-05",time:"07:07 PM",opponent:"Orioles",assignee:"Jay",onBoard:false,postedBy:""},
{id:32,date:"2026-06-06",time:"03:07 PM",opponent:"Orioles",assignee:"Geoff",onBoard:false,postedBy:""},
{id:33,date:"2026-06-07",time:"01:37 PM",opponent:"Orioles",assignee:"Jay",onBoard:false,postedBy:""},
{id:34,date:"2026-06-08",time:"07:07 PM",opponent:"Phillies",assignee:"Rob",onBoard:false,postedBy:""},
{id:35,date:"2026-06-09",time:"07:07 PM",opponent:"Phillies",assignee:"Geoff",onBoard:false,postedBy:""},
{id:36,date:"2026-06-10",time:"07:07 PM",opponent:"Phillies",assignee:"Leanne",onBoard:false,postedBy:""},
{id:37,date:"2026-06-12",time:"07:37 PM",opponent:"Yankees",assignee:"Geoff",onBoard:false,postedBy:""},
{id:38,date:"2026-06-13",time:"03:07 PM",opponent:"Yankees",assignee:"Rob",onBoard:false,postedBy:""},
{id:39,date:"2026-06-14",time:"01:37 PM",opponent:"Yankees",assignee:"Jay",onBoard:false,postedBy:""},
{id:40,date:"2026-06-22",time:"07:07 PM",opponent:"Astros",assignee:"Leanne",onBoard:false,postedBy:""},
{id:41,date:"2026-06-23",time:"07:07 PM",opponent:"Astros",assignee:"Jay",onBoard:false,postedBy:""},
{id:42,date:"2026-06-24",time:"07:07 PM",opponent:"Astros",assignee:"Geoff",onBoard:false,postedBy:""},
{id:43,date:"2026-06-25",time:"07:07 PM",opponent:"Rangers",assignee:"Jay",onBoard:false,postedBy:""},
{id:44,date:"2026-06-26",time:"07:07 PM",opponent:"Rangers",assignee:"Geoff",onBoard:false,postedBy:""},
{id:45,date:"2026-06-27",time:"03:07 PM",opponent:"Rangers",assignee:"Leanne",onBoard:false,postedBy:""},
{id:46,date:"2026-06-28",time:"01:37 PM",opponent:"Rangers",assignee:"Rob",onBoard:false,postedBy:""},
{id:47,date:"2026-06-29",time:"07:07 PM",opponent:"Mets",assignee:"Leanne",onBoard:false,postedBy:""},
{id:48,date:"2026-06-30",time:"07:07 PM",opponent:"Mets",assignee:"Rob",onBoard:false,postedBy:""},
{id:49,date:"2026-07-01",time:"03:07 PM",opponent:"Mets",assignee:"Jay",onBoard:false,postedBy:""},
{id:50,date:"2026-07-17",time:"07:07 PM",opponent:"White Sox",assignee:"Geoff",onBoard:false,postedBy:""},
{id:51,date:"2026-07-18",time:"03:07 PM",opponent:"White Sox",assignee:"Leanne",onBoard:false,postedBy:""},
{id:52,date:"2026-07-19",time:"12:15 PM",opponent:"White Sox",assignee:"Geoff",onBoard:false,postedBy:""},
{id:53,date:"2026-07-20",time:"07:07 PM",opponent:"Rays",assignee:"Rob",onBoard:false,postedBy:""},
{id:54,date:"2026-07-21",time:"07:07 PM",opponent:"Rays",assignee:"Jay",onBoard:false,postedBy:""},
{id:55,date:"2026-07-22",time:"07:07 PM",opponent:"Rays",assignee:"Leanne",onBoard:false,postedBy:""},
{id:56,date:"2026-07-23",time:"03:07 PM",opponent:"Rays",assignee:"Rob",onBoard:false,postedBy:""},
{id:57,date:"2026-07-31",time:"07:07 PM",opponent:"Cardinals",assignee:"Leanne",onBoard:false,postedBy:""},
{id:58,date:"2026-08-01",time:"03:07 PM",opponent:"Cardinals",assignee:"Rob",onBoard:false,postedBy:""},
{id:59,date:"2026-08-02",time:"01:37 PM",opponent:"Cardinals",assignee:"Jay",onBoard:false,postedBy:""},
{id:60,date:"2026-08-10",time:"07:07 PM",opponent:"Red Sox",assignee:"Geoff",onBoard:false,postedBy:""},
{id:61,date:"2026-08-11",time:"07:07 PM",opponent:"Red Sox",assignee:"Jay",onBoard:false,postedBy:""},
{id:62,date:"2026-08-12",time:"07:07 PM",opponent:"Red Sox",assignee:"Rob",onBoard:false,postedBy:""},
{id:63,date:"2026-08-13",time:"03:07 PM",opponent:"Red Sox",assignee:"Leanne",onBoard:false,postedBy:""},
{id:64,date:"2026-08-14",time:"07:07 PM",opponent:"Yankees",assignee:"Rob",onBoard:false,postedBy:""},
{id:65,date:"2026-08-15",time:"03:07 PM",opponent:"Yankees",assignee:"Leanne",onBoard:false,postedBy:""},
{id:66,date:"2026-08-16",time:"01:37 PM",opponent:"Yankees",assignee:"Jay",onBoard:false,postedBy:""},
{id:67,date:"2026-08-25",time:"07:07 PM",opponent:"Royals",assignee:"Leanne",onBoard:false,postedBy:""},
{id:68,date:"2026-08-26",time:"07:07 PM",opponent:"Royals",assignee:"Geoff",onBoard:false,postedBy:""},
{id:69,date:"2026-08-27",time:"07:07 PM",opponent:"Royals",assignee:"Jay",onBoard:false,postedBy:""},
{id:70,date:"2026-08-28",time:"07:07 PM",opponent:"Mariners",assignee:"Geoff",onBoard:false,postedBy:""},
{id:71,date:"2026-08-29",time:"03:07 PM",opponent:"Mariners",assignee:"Leanne",onBoard:false,postedBy:""},
{id:72,date:"2026-08-30",time:"01:37 PM",opponent:"Mariners",assignee:"Geoff",onBoard:false,postedBy:""},
{id:73,date:"2026-09-11",time:"07:07 PM",opponent:"Orioles",assignee:"Jay",onBoard:false,postedBy:""},
{id:74,date:"2026-09-12",time:"03:07 PM",opponent:"Orioles",assignee:"Leanne",onBoard:false,postedBy:""},
{id:75,date:"2026-09-13",time:"01:37 PM",opponent:"Orioles",assignee:"Rob",onBoard:false,postedBy:""},
{id:76,date:"2026-09-14",time:"07:07 PM",opponent:"Tigers",assignee:"Geoff",onBoard:false,postedBy:""},
{id:77,date:"2026-09-15",time:"07:07 PM",opponent:"Tigers",assignee:"Leanne",onBoard:false,postedBy:""},
{id:78,date:"2026-09-16",time:"03:07 PM",opponent:"Tigers",assignee:"Geoff",onBoard:false,postedBy:""},
{id:79,date:"2026-09-25",time:"07:07 PM",opponent:"Reds",assignee:"Rob",onBoard:false,postedBy:""},
{id:80,date:"2026-09-26",time:"03:07 PM",opponent:"Reds",assignee:"Jay",onBoard:false,postedBy:""},
{id:81,date:"2026-09-27",time:"03:07 PM",opponent:"Reds",assignee:"Rob",onBoard:false,postedBy:""},
];

const PEOPLE=['Jay','Leanne','Geoff','Rob'];
const PC={Jay:'var(--jay)',Leanne:'var(--leanne)',Geoff:'var(--geoff)',Rob:'var(--rob)'};
const MONTHS=[{k:'2026-03',l:'March'},{k:'2026-04',l:'April'},{k:'2026-05',l:'May'},{k:'2026-06',l:'June'},{k:'2026-07',l:'July'},{k:'2026-08',l:'August'},{k:'2026-09',l:'September'}];
const DAYNAMES=['Sun','Mon','Tue','Wed','Thu','Fri','Sat'];

let S={user:null,games:JSON.parse(JSON.stringify(INITIAL_GAMES)),history:[],view:'calendar',filter:'all',month:'2026-03',notif:null,confirm:null,lastSync:null,syncing:false};

// SYNC ‚Äî ALL communication via JSONP (script tag injection)
// This is the only method that reliably bypasses CORS with Google Apps Script
// Both READ and WRITE go through GET requests with callback parameters

function jsonpCall(params){
  return new Promise((resolve)=>{
    const cbName='_jcb'+Date.now()+(Math.random()*1000|0);
    const timer=setTimeout(()=>{resolve(null);delete window[cbName];try{script.remove();}catch(e){}},15000);
    window[cbName]=function(data){clearTimeout(timer);resolve(data);delete window[cbName];try{script.remove();}catch(e){}};
    const script=document.createElement('script');
    script.onerror=()=>{clearTimeout(timer);resolve(null);delete window[cbName];try{script.remove();}catch(e){}};
    const qs=Object.keys(params).map(k=>k+'='+encodeURIComponent(params[k])).join('&');
    script.src=APPS_SCRIPT_URL+'?callback='+cbName+'&'+qs;
    document.body.appendChild(script);
  });
}

function cloudGet(){
  if(!APPS_SCRIPT_URL)return Promise.resolve(null);
  return jsonpCall({action:'getData'});
}

async function cloudPost(){
  if(!APPS_SCRIPT_URL){saveLocal();return;}
  saveLocal();
  // Send data as a URL-encoded parameter via JSONP GET
  const payload=JSON.stringify({games:S.games,history:S.history});
  const result=await jsonpCall({action:'saveData',payload:payload});
  if(result&&result.success)S.lastSync=new Date();
  else console.error('cloudPost failed:',result);
}

async function pullCloud(){
  S.syncing=true;render();
  const d=await cloudGet();
  if(d){if(d.games&&d.games.length>0)S.games=d.games;if(d.history)S.history=d.history;S.lastSync=new Date();saveLocal();}
  S.syncing=false;render();
}
function saveLocal(){localStorage.setItem('j26g',JSON.stringify(S.games));localStorage.setItem('j26h',JSON.stringify(S.history));}
function loadLocal(){try{const g=localStorage.getItem('j26g'),h=localStorage.getItem('j26h');if(g)S.games=JSON.parse(g);if(h)S.history=JSON.parse(h);}catch(e){}}

// HELPERS
function fd(d){return new Date(d+'T12:00:00').toLocaleDateString('en-US',{weekday:'short',month:'short',day:'numeric'});}
function dw(d){return new Date(d+'T12:00:00').toLocaleDateString('en-US',{weekday:'short'});}
function mi(ym){const[y,m]=ym.split('-').map(Number);return{fd:new Date(y,m-1,1).getDay(),days:new Date(y,m,0).getDate(),y,m};}
function cts(){const c={};PEOPLE.forEach(p=>c[p]=S.games.filter(g=>g.assignee===p&&!g.onBoard).length);return c;}
function bg(){return S.games.filter(g=>g.onBoard);}
function today(){return new Date().toISOString().split('T')[0];}

function notify(msg,type='info'){S.notif={msg,type};render();setTimeout(()=>{S.notif=null;render();},3000);}
function showConfirm(title,msg,onYes){S.confirm={title,msg,onYes};render();}
function closeConfirm(){S.confirm=null;render();}

// ACTIONS
function login(p){S.user=p;localStorage.setItem('j26u',p);render();}
function logout(){S.user=null;localStorage.removeItem('j26u');render();}
function setView(v){S.view=v;render();}
function setMonth(m){S.month=m;render();}
function toggleFilter(p){S.filter=S.filter===p?'all':p;render();}
function clearFilter(){S.filter='all';render();}

function postToBoard(gid){
  const g=S.games.find(x=>x.id===gid);
  if(!g||g.assignee!==S.user)return;
  showConfirm('Post to Swap Board','Post <strong>#'+g.id+' '+fd(g.date)+' vs '+g.opponent+'</strong> to the swap board?<br><br>Anyone can claim it. Your game count will decrease by 1.',async()=>{
    g.onBoard=true;g.postedBy=S.user;closeConfirm();await cloudPost();notify('Game #'+g.id+' posted to swap board!','success');render();
  });
}

async function unpost(gid){
  const g=S.games.find(x=>x.id===gid);if(!g)return;
  g.onBoard=false;g.postedBy='';await cloudPost();notify('Removed from swap board.','info');render();
}

function claimGame(gid){
  const g=S.games.find(x=>x.id===gid);if(!g||!g.onBoard)return;
  showConfirm('Claim This Game','Take <strong>#'+g.id+' '+fd(g.date)+' vs '+g.opponent+'</strong> from '+(g.postedBy||g.assignee)+'?<br><br>Your game count will increase by 1.',async()=>{
    const prev=g.assignee;
    S.history.push({id:Date.now(),gameId:g.id,from:prev,to:S.user,gameDesc:'#'+g.id+' '+fd(g.date)+' vs '+g.opponent,timestamp:new Date().toISOString()});
    g.assignee=S.user;g.onBoard=false;g.postedBy='';closeConfirm();await cloudPost();notify('You claimed game #'+g.id+'!','success');render();
  });
}

async function clearHistory(){S.history=[];await cloudPost();render();}

function resetAll(){
  showConfirm('Reset Everything','This will restore all original assignments and clear all swap history. Are you sure?',async()=>{
    S.games=JSON.parse(JSON.stringify(INITIAL_GAMES));S.history=[];closeConfirm();await cloudPost();notify('Reset to original assignments.','info');render();
  });
}

async function manualSync(){await pullCloud();if(S.lastSync)notify('Synced!','success');else notify('Could not reach Google Sheets.','error');}

// RENDER
function render(){
  const app=document.getElementById('app');
  const c=cts();const board=bg();let h='';

  if(S.notif)h+='<div class="notification '+S.notif.type+'">'+S.notif.msg+'</div>';

  if(S.confirm){
    h+='<div class="modal-overlay" onclick="closeConfirm()"><div class="modal-box" onclick="event.stopPropagation()"><h3>'+S.confirm.title+'</h3><p>'+S.confirm.msg+'</p><div class="modal-actions"><button class="btn-primary" onclick="S.confirm.onYes()">Yes, do it</button><button class="btn-secondary" onclick="closeConfirm()">Cancel</button></div></div></div>';
  }

  // LOGIN
  if(!S.user){
    app.innerHTML=h+'<div class="login-screen"><div class="login-box"><span class="logo">‚öæ</span><h1>Blue Jays 2026</h1><p class="subtitle">Home Game Dashboard</p><p class="prompt">Who are you?</p>'+PEOPLE.map(p=>'<button class="login-btn" data-p="'+p+'" onclick="login(\''+p+'\')"><span class="dot" style="background:'+PC[p]+'"></span>'+p+'<span class="count">'+c[p]+' games</span></button>').join('')+'<p style="color:var(--text-muted);font-size:11px;margin-top:24px">'+(APPS_SCRIPT_URL?'‚òÅÔ∏è Syncing via Google Sheets':'üíæ Local mode')+'</p></div></div>';
    return;
  }

  const filtered=S.filter==='all'?S.games:S.games.filter(g=>g.assignee===S.filter);
  const bc=board.length;

  // HEADER
  h+='<div class="header"><div class="header-left"><span class="logo">‚öæ</span><div><h1>Blue Jays 2026</h1><span class="tag">Home Schedule</span></div></div><div class="header-right">'+(bc>0?'<span class="board-badge">'+bc+' on board</span>':'')+'<div class="user-badge"><span class="dot" style="background:'+PC[S.user]+'"></span>'+S.user+'</div><button class="btn-sm" onclick="manualSync()">'+(S.syncing?'‚è≥':'‚Üª')+' Sync</button><button class="btn-sm" onclick="logout()">Switch</button></div></div>';

  // STATS
  const orig={};PEOPLE.forEach(p=>orig[p]=INITIAL_GAMES.filter(g=>g.assignee===p).length);
  h+='<div class="stats-bar">'+PEOPLE.map(p=>{
    const diff=c[p]-orig[p];const ds=diff>0?'+'+diff:diff<0?''+diff:'';
    return '<div class="stat-block '+(S.filter!=='all'&&S.filter!==p?'dimmed':'')+'" style="background:'+PC[p]+';flex:'+(c[p]||1)+'" onclick="toggleFilter(\''+p+'\')"><div class="num">'+c[p]+'</div><div class="label">'+p+'</div>'+(ds?'<div class="diff">'+ds+'</div>':'')+'</div>';
  }).join('')+'</div>';

  // CONTROLS
  const mt=S.view==='calendar'?'<div class="month-tabs">'+MONTHS.map(m=>'<button class="month-btn '+(S.month===m.k?'active':'')+'" onclick="setMonth(\''+m.k+'\')">'+m.l.slice(0,3)+'</button>').join('')+'</div>':'';
  h+='<div class="controls"><div class="tab-group">';
  [['calendar','Calendar'],['list','List'],['board','Swap Board'+(bc>0?' ('+bc+')':'')]].forEach(([k,l])=>{
    h+='<button class="tab-btn '+(S.view===k?'active':'')+'" onclick="setView(\''+k+'\')">'+l+'</button>';
  });
  h+='</div>'+mt+'<div class="filter-group"><button class="btn-sm" style="'+(S.filter==='all'?'background:rgba(255,255,255,0.1);color:var(--text-primary)':'')+'" onclick="clearFilter()">All</button></div></div>';

  // CALENDAR
  if(S.view==='calendar'){
    const inf=mi(S.month);const mg=filtered.filter(g=>g.date.startsWith(S.month));
    const bd={};mg.forEach(g=>{const d=parseInt(g.date.split('-')[2]);if(!bd[d])bd[d]=[];bd[d].push(g);});
    const td=today();
    let cells=DAYNAMES.map(d=>'<div class="cal-header">'+d+'</div>').join('');
    for(let i=0;i<inf.fd;i++)cells+='<div class="cal-day empty"></div>';
    for(let d=1;d<=inf.days;d++){
      const ds=inf.y+'-'+String(inf.m).padStart(2,'0')+'-'+String(d).padStart(2,'0');
      const it=ds===td;const dg=bd[d]||[];
      const chips=dg.map(g=>{
        const mine=g.assignee===S.user&&!g.onBoard;const dim=S.filter!=='all'&&g.assignee!==S.filter;const ob=g.onBoard;
        return '<div class="game-chip '+(mine?'mine':'')+' '+(dim?'dimmed':'')+' '+(ob?'on-board':'')+'" style="background:'+PC[g.assignee]+'" '+(mine?'onclick="postToBoard('+g.id+')"':'')+'><div class="opp">vs '+g.opponent+'</div><div class="meta">'+g.time+' ¬∑ '+g.assignee+(ob?' ¬∑ üîÑ':'')+'</div></div>';
      }).join('');
      cells+='<div class="cal-day '+(it?'today':'')+'"><div class="day-num">'+d+'</div>'+chips+'</div>';
    }
    h+='<div class="calendar"><div class="cal-grid">'+cells+'</div><p class="cal-hint">Click your games to post them to the swap board</p></div>';
  }

  // LIST
  if(S.view==='list'){
    const rows=filtered.map(g=>{
      const mine=g.assignee===S.user&&!g.onBoard;const ob=g.onBoard;
      let ab='';
      if(mine)ab='<button class="action-btn post" onclick="postToBoard('+g.id+')">Post</button>';
      else if(ob&&g.assignee!==S.user)ab='<button class="action-btn grab" onclick="claimGame('+g.id+')">Claim</button>';
      else if(ob&&(g.postedBy===S.user||g.assignee===S.user))ab='<button class="action-btn unpost" onclick="unpost('+g.id+')">Remove</button>';
      return '<tr style="'+(ob?'opacity:0.6':'')+'"><td style="color:var(--text-muted);font-weight:500">'+g.id+'</td><td style="font-weight:500">'+fd(g.date)+'</td><td style="color:var(--text-secondary)">'+dw(g.date)+'</td><td style="color:var(--text-secondary)">'+g.time+'</td><td style="font-weight:600">'+g.opponent+'</td><td><span class="assignee-pill" style="background:'+PC[g.assignee]+'">'+g.assignee+'</span>'+(ob?' <span style="font-size:10px;color:var(--rob)">üîÑ</span>':'')+'</td><td>'+ab+'</td></tr>';
    }).join('');
    h+='<div class="list-view"><table class="list-table"><thead><tr><th>#</th><th>Date</th><th>Day</th><th>Time</th><th>Opponent</th><th>Assigned</th><th></th></tr></thead><tbody>'+rows+'</tbody></table></div>';
  }

  // SWAP BOARD
  if(S.view==='board'){
    let bh='';
    if(board.length===0){
      bh='<div class="empty-state">No games on the swap board right now.<br><br>To post a game, click one of your games in the Calendar or List view.</div>';
    }else{
      bh=board.map(g=>{
        const canClaim=g.assignee!==S.user&&g.postedBy!==S.user;
        const canRemove=g.postedBy===S.user||g.assignee===S.user;
        return '<div class="board-card"><div><div class="game-info"><strong>#'+g.id+' ‚Äî '+fd(g.date)+' vs '+g.opponent+'</strong><div class="sub">'+dw(g.date)+' ¬∑ '+g.time+'</div></div><div class="posted-by">Posted by <span style="color:'+PC[g.postedBy||g.assignee]+';font-weight:600">'+(g.postedBy||g.assignee)+'</span></div></div><div class="board-actions">'+(canClaim?'<button class="btn-claim" onclick="claimGame('+g.id+')">Claim This Game</button>':'')+(canRemove?'<button class="btn-remove" onclick="unpost('+g.id+')">Remove</button>':'')+'</div></div>';
      }).join('');
    }

    let hh='';
    if(S.history.length>0){
      hh='<div class="history-section"><div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:10px"><div class="board-title" style="margin:0">Swap History</div><div style="display:flex;gap:8px"><button class="btn-sm" onclick="clearHistory()">Clear</button><button class="btn-sm" style="border-color:rgba(239,68,68,0.3);color:#EF4444" onclick="resetAll()">Reset All</button></div></div>'+S.history.slice().reverse().map(x=>'<div class="history-card"><div>'+x.gameDesc+': <span style="color:'+PC[x.from]+';font-weight:600">'+x.from+'</span> ‚Üí <span style="color:'+PC[x.to]+';font-weight:600">'+x.to+'</span></div><span class="status-tag" style="background:var(--geoff)">swapped</span></div>').join('')+'</div>';
    }else{
      hh='<div class="history-section"><div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:10px"><div class="board-title" style="margin:0">Swap History</div><button class="btn-sm" style="border-color:rgba(239,68,68,0.3);color:#EF4444" onclick="resetAll()">Reset All</button></div><div style="padding:20px;text-align:center;color:var(--text-muted);font-size:13px">No swaps yet.</div></div>';
    }

    h+='<div class="swap-board"><div class="board-header"><div class="board-title">Available Games ('+board.length+')</div></div>'+bh+hh+'</div>';
  }

  // FOOTER
  const sl=APPS_SCRIPT_URL?'‚òÅÔ∏è Google Sheets'+(S.lastSync?' ¬∑ Last sync: '+S.lastSync.toLocaleTimeString():''):'üíæ Local mode';
  h+='<div class="footer"><span>'+sl+'</span><span>81 home games ¬∑ 2026 Season</span></div>';

  app.innerHTML=h;
}

// INIT
(async function(){
  const sv=localStorage.getItem('j26u');
  if(sv&&PEOPLE.includes(sv))S.user=sv;
  loadLocal();render();
  if(APPS_SCRIPT_URL)await pullCloud();
})();

</script>
</body>
</html>
